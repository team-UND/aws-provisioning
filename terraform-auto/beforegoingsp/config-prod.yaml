# Apply stages are defined in the order they should be applied
apply_stages:
  - name: "Stage 1: VPC"
    parallel: false
    directories:
      - path: ../../terraform/vpc/beforegoingp_apnortheast2
        enabled: true
  - name: "Stage 2: Data Stores & Load Balancer"
    parallel: true
    directories:
      - path: ../../terraform/rds/teamund/beforegoingp_apnortheast2
        enabled: true
      - path: ../../terraform/elasticache/teamund/beforegoingp_apnortheast2
        enabled: true
      - path: ../../terraform/s3/teamund/beforegoingp_apnortheast2
        enabled: true
      - path: ../../terraform/lb/teamund/beforegoingp_apnortheast2
        enabled: true
  - name: "Stage 3: Identity & Security"
    parallel: true
    directories:
      - path: ../../terraform/iam/teamund/beforegoingp_apnortheast2
        enabled: true
      - path: ../../terraform/waf/teamund/beforegoingp_apnortheast2
        enabled: true
  - name: "Stage 4: Compute"
    parallel: false
    directories:
      - path: ../../terraform/ecs/teamund/beforegoingp_apnortheast2
        enabled: true
  - name: "Stage 5: Services"
    parallel: true
    directories:
      - path: ../../terraform/services/teamund/beforegoingp_apnortheast2
        enabled: true
      - path: ../../terraform/lambda/teamund/beforegoingp_apnortheast2
        enabled: true
  - name: "Stage 6: API Gateway"
    parallel: false
    directories:
      - path: ../../terraform/apigw/teamund/beforegoingp_apnortheast2
        enabled: true
  - name: "Stage 7: CDN"
    parallel: false
    directories:
      - path: ../../terraform/cloudfront/teamund/beforegoingp_apnortheast2
        enabled: true

# Destroy stages are defined in reverse order of apply stages
destroy_stages:
  - name: "Stage 1: CDN"
    parallel: false
    directories:
      - path: ../../terraform/cloudfront/teamund/beforegoingp_apnortheast2
        enabled: true
  - name: "Stage 2: API Gateway"
    parallel: false
    directories:
      - path: ../../terraform/apigw/teamund/beforegoingp_apnortheast2
        enabled: true
  - name: "Stage 3: Services"
    parallel: true
    directories:
      - path: ../../terraform/services/teamund/beforegoingp_apnortheast2
        enabled: true
      - path: ../../terraform/lambda/teamund/beforegoingp_apnortheast2
        enabled: true
  - name: "Stage 4: Compute"
    parallel: false
    directories:
      - path: ../../terraform/ecs/teamund/beforegoingp_apnortheast2
        enabled: true
  - name: "Stage 5: Identity & Security"
    parallel: true
    directories:
      - path: ../../terraform/iam/teamund/beforegoingp_apnortheast2
        enabled: true
      - path: ../../terraform/waf/teamund/beforegoingp_apnortheast2
        enabled: true
  - name: "Stage 6: Data Stores & Load Balancer"
    parallel: true
    directories:
      - path: ../../terraform/rds/teamund/beforegoingp_apnortheast2
        enabled: true
      - path: ../../terraform/elasticache/teamund/beforegoingp_apnortheast2
        enabled: true
      - path: ../../terraform/s3/teamund/beforegoingp_apnortheast2
        enabled: true
      - path: ../../terraform/lb/teamund/beforegoingp_apnortheast2
        enabled: true
  - name: "Stage 7: VPC"
    parallel: false
    directories:
      - path: ../../terraform/vpc/beforegoingp_apnortheast2
        enabled: true
